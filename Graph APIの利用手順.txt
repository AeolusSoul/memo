
å¿…è¦ãªå¥‘ç´„
ãƒ»Microsoft 365 Business Basic Â¥899
ãƒ»Azure ãƒãƒ¼ã‚¿ãƒ«ã¸ã®ãƒ­ã‚°ã‚¤ãƒ³(ã‚µãƒ–ã‚¹ã‚¯å¥‘ç´„ãªã—ã§ok)

--
1.Microsoft 365 Business Basicå¥‘ç´„

URL:
https://www.microsoft.com/ja-jp/microsoft-365/business/microsoft-365-plans-and-pricing
â†“
ç„¡æ–™ã§è©¦ã™
â†“
ãƒ†ãƒŠãƒ³ãƒˆå(ä¼šç¤¾ã®ãƒ‰ãƒ¡ã‚¤ãƒ³)ï¼šxxx.onmicrosoft.com
ç®¡ç†è€…ã‚¢ã‚«ã‚¦ãƒ³ãƒˆ(å…¨æ¨©é™)ï¼š aaa@xxx.onmicrosoft.com
â†“
å¥‘ç´„å¾Œã€Microsoft 365 ç®¡ç†ã‚»ãƒ³ã‚¿ãƒ¼ã¸ã‚¢ã‚¯ã‚»ã‚¹
URL:
https://admin.microsoft.com
â†“
ç®¡ç†è€…ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã§ãƒ­ã‚°ã‚¤ãƒ³ã§ã„ã¦ã„ã‚Œã°ok

--
2.SharePointã‚µã‚¤ãƒˆä½œæˆ

Microsoft 365 ç®¡ç†ã‚»ãƒ³ã‚¿ãƒ¼é–‹ã
URL:
https://admin.microsoft.com
â†“
ã‚µã‚¤ãƒ‰ãƒ¡ãƒ‹ãƒ¥ãƒ¼
ç®¡ç†ã‚»ãƒ³ã‚¿ãƒ¼ > Sharepoint
â†“
ã‚µã‚¤ãƒ‰ãƒ¡ãƒ‹ãƒ¥ãƒ¼
ã‚µã‚¤ãƒˆ > ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãªã‚µã‚¤ãƒˆ > ä½œæˆ > ãƒãƒ¼ãƒ ã‚µã‚¤ãƒˆ > æ¨™æº–ãƒãƒ¼ãƒ  > ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’ä½¿ç”¨
â†“
ã‚µã‚¤ãƒˆåï¼štest
ã‚µã‚¤ãƒˆã®èª¬æ˜ï¼štest
ã‚°ãƒ«ãƒ¼ãƒ—ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ï¼štest
ã‚µã‚¤ãƒˆã‚¢ãƒ‰ãƒ¬ã‚¹ï¼šhttps://xxx.sharepoint.com/sites/test
ã‚°ãƒ«ãƒ¼ãƒ—ã®æ‰€æœ‰è€…ï¼šè‡ªåˆ†ã®åå‰è¡¨é¸æŠ
æ¬¡ã¸
â†“
ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ã®è¨­å®šï¼šãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆ
è¨€èªã®é¸æŠï¼šæ—¥æœ¬èª
ã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³ï¼š(UTC+09:00)å¤§é˜ªã€æœ­å¹Œã€æ±äº¬
ã‚µã‚¤ãƒˆã®ä½œæˆ
â†“
ãƒ¡ãƒ³ãƒãƒ¼ã®è¿½åŠ ï¼šç©ºç™½ã§ok
å®Œäº†
â†“
ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãªã‚µã‚¤ãƒˆã«testãŒè¿½åŠ ã•ã‚Œã‚‹
URL:
https://xxx.sharepoint.com/sites/test

--
3.SharePointã‚µã‚¤ãƒˆå†…ã«ãƒ•ã‚©ãƒ«ãƒ€ä½œæˆ

ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãªã‚µã‚¤ãƒˆ>testã®URLã‚¯ãƒªãƒƒã‚¯
â†“
ã‚µã‚¤ãƒ‰ãƒãƒ¼>ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
â†“
ä½œæˆã¾ãŸã¯ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ > ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ 
â†“
åå‰ï¼štest_app  

--
2.SharePointã‚µã‚¤ãƒˆ>test_appã«PDFãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰

SharePoint > ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ > test_appé–‹ã
â†“
ä½œæˆã¾ãŸã¯ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ > ãƒ•ã‚¡ã‚¤ãƒ«ã®ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
â†“
ãƒ­ãƒ¼ã‚«ãƒ«ã®PDFãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠã—ã€ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
â†“
ã„ãã¤ã‹ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ã¦ãŠã

--
4.Azureãƒãƒ¼ã‚¿ãƒ«ã«Businessã‚¢ã‚«ã‚¦ãƒ³ãƒˆã§å…¥ã‚Šã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ç™»éŒ²

Azureãƒãƒ¼ã‚¿ãƒ«ã¸ã‚¢ã‚¯ã‚»ã‚¹
https://portal.azure.com
â†“
ç®¡ç†è€…ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã§ãƒ­ã‚°ã‚¤ãƒ³ã§ã„ã¦ã„ã‚Œã°ok
aaa@xxx.onmicrosoft.com
â†“
Microsoft Entra ID
â†“
ã‚¯ã‚¤ãƒƒã‚¯ ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ > ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ç™»éŒ²ã‚’è¿½åŠ 
â†“
åå‰ï¼štest_app
ã‚µãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ã‚‹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®ç¨®é¡ï¼šã‚·ãƒ³ã‚°ãƒ«ãƒ†ãƒŠãƒ³ãƒˆã®ã¿
ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆURIï¼šç©ºç™½
ç™»éŒ²
â†“
ã‚¢ãƒ—ãƒªãŒç™»éŒ²ã•ã‚Œã‚‹ãƒ»IDæ§ãˆã‚‹
è¡¨ç¤ºåï¼štest_app
ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ (ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ)IDï¼šaaa
ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆIDï¼šbbb
ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª (ãƒ†ãƒŠãƒ³ãƒˆ) ID:ccc
ã‚µãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ã‚‹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆï¼šæ‰€å±ã™ã‚‹çµ„ç¹”ã®ã¿
â†“
Client Secretä½œæˆ
ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®è³‡æ ¼æƒ…å ± > è¨¼æ˜æ›¸ã¾ãŸã¯ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆã®è¿½åŠ 
â†“
æ–°ã—ã„ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆ
â†“
èª¬æ˜ï¼štest_app
æœ‰åŠ¹æœŸé™ï¼šæ¨å¥¨180æ—¥(6ãƒ¶æœˆ)
è¿½åŠ 
â†“
ä½œæˆã•ã‚Œã‚‹ãƒ»å€¤æ§ãˆã‚‹
æœ‰åŠ¹æœŸé™ï¼š2026/8/14
å€¤(ä¸€åº¦ã—ã‹è¡¨ç¤ºã•ã‚Œãªã„)ï¼šxxx
ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆIDï¼šxxx
â†“
APIã‚¢ã‚¯ã‚»ã‚¹è¨±å¯
ã‚µã‚¤ãƒ‰ãƒãƒ¼ > APIã®ã‚¢ã‚¯ã‚»ã‚¹è¨±å¯ > ã‚¢ã‚¯ã‚»ã‚¹è¨±å¯ã®è¿½åŠ 
â†“
APIã‚¢ã‚¯ã‚»ã‚¹è¨±å¯ã®è¦æ±‚ > Microsofr Graph > ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®è¨±å¯
â†“
ãƒã‚§ãƒƒã‚¯å…¥ã‚Œã‚‹
Files > Files.Read.ALl
Sites > Sites.Read.All
ã‚¢ã‚¯ã‚»ã‚¹è¨±å¯ã®è¿½åŠ 
â†“
ã€‡ã€‡ã«ç®¡ç†è€…ã®åŒæ„ã‚’ä¸ãˆã¾ã™
ã¯ã„
â†“
çŠ¶æ…‹ï¼šã€‡ã€‡ã«ä»˜ä¸ã•ã‚Œã¾ã—ãŸ
ã¨ãªã‚‹

--
5.ãƒ­ãƒ¼ã‚«ãƒ«ã«Pythonä½œæˆ

cmd:
mkdir sp-test
cd sp-test
python3 -m venv venv
source venv/bin/activate
pip install requests
â†“
cmd:
touch app.py
â†“
.pyã®ä¸­èº«è¨˜è¿°
import requests

# ===== ã‚ãªãŸã®æƒ…å ±ã‚’å…¥åŠ› =====
tenant_id = "ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ID"
client_id = "ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªID"
client_secret = "ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆå€¤"
site_hostname = "xxx.sharepoint.com"
site_path = "/sites/test"
folder_path = "test_app"
# ============================

# 1ï¸âƒ£ ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³å–å¾—
token_url = f"https://login.microsoftonline.com/{tenant_id}/oauth2/v2.0/token"

token_data = {
    "grant_type": "client_credentials",
    "client_id": client_id,
    "client_secret": client_secret,
    "scope": "https://graph.microsoft.com/.default"
}

token_res = requests.post(token_url, data=token_data)
access_token = token_res.json()["access_token"]

headers = {
    "Authorization": f"Bearer {access_token}"
}

print("âœ… ãƒˆãƒ¼ã‚¯ãƒ³å–å¾—æˆåŠŸ")

# 2ï¸âƒ£ Site IDå–å¾—
site_api = f"https://graph.microsoft.com/v1.0/sites/{site_hostname}:{site_path}"
site_res = requests.get(site_api, headers=headers)
site_id = site_res.json()["id"]

print("âœ… Site ID:", site_id)

# 3ï¸âƒ£ Drive IDå–å¾—
drive_api = f"https://graph.microsoft.com/v1.0/sites/{site_id}/drive"
drive_res = requests.get(drive_api, headers=headers)
drive_id = drive_res.json()["id"]

print("âœ… Drive ID:", drive_id)

# 4ï¸âƒ£ testãƒ•ã‚©ãƒ«ãƒ€å±æ€§å–å¾—
folder_api = f"https://graph.microsoft.com/v1.0/drives/{drive_id}/root:/{folder_path}"
folder_res = requests.get(folder_api, headers=headers)
folder_data = folder_res.json()

print("ğŸ“‚ ãƒ•ã‚©ãƒ«ãƒ€å:", folder_data["name"])
print("ğŸ•’ ä½œæˆæ—¥æ™‚:", folder_data["createdDateTime"])
print("ğŸ•’ æ›´æ–°æ—¥æ™‚:", folder_data["lastModifiedDateTime"])
print("ğŸ“¦ ãƒ•ã‚©ãƒ«ãƒ€åˆè¨ˆã‚µã‚¤ã‚º(bytes):", folder_data["size"])
print("ğŸŒ Web URL:", folder_data["webUrl"])

# 5ï¸âƒ£ testãƒ•ã‚©ãƒ«ãƒ€å†…ã®ãƒ•ã‚¡ã‚¤ãƒ«ä¸€è¦§å–å¾—
children_api = f"https://graph.microsoft.com/v1.0/drives/{drive_id}/root:/{folder_path}:/children"
children_res = requests.get(children_api, headers=headers)
children_data = children_res.json()

print("\n---- testãƒ•ã‚©ãƒ«ãƒ€å†… ----")

total_size = 0

for item in children_data.get("value", []):
    name = item.get("name")
    size = item.get("size", 0)
    item_type = "ãƒ•ã‚©ãƒ«ãƒ€" if "folder" in item else "ãƒ•ã‚¡ã‚¤ãƒ«"

    print("åå‰:", name)
    print("ç¨®é¡:", item_type)
    print("ã‚µã‚¤ã‚º(bytes):", size)
    print("ä½œæˆæ—¥æ™‚:", item.get("createdDateTime"))
    print("æ›´æ–°æ—¥æ™‚:", item.get("lastModifiedDateTime"))
    print("-----")

    total_size += size

print("ğŸ“¦ ä¸­èº«åˆè¨ˆã‚µã‚¤ã‚º(bytes):", total_size)
print("ğŸ“¦ ä¸­èº«åˆè¨ˆã‚µã‚¤ã‚º(MB):", round(total_size / (1024 * 1024), 3))

â†“
cmd:
python app.py

--


